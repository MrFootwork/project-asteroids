var I=a=>{throw TypeError(a)};var ae=(a,e,t)=>e.has(a)||I("Cannot "+t);var f=(a,e,t)=>e.has(a)?I("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t);var o=(a,e,t)=>(ae(a,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const h of r.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();var d,R,T,P,C,F;class he{constructor({spaceshipElement:e,gameScreen:t,keys:s}){f(this,d);this.gameScreen=t,this.element=e,this.keys=s,this.isAccelerating=!1,this.isDecelerating=!1,this.ANGLE_OFFSET=Math.PI/2,this.SPEED=8,this.ROTATIONAL_SPEED=.2,this.position={x:200,y:400},this.velocity={x:0,y:0},this.rotaionalVelocity=0,this.orientation=0,this.thrustOrientation=0}update(){o(this,d,T).call(this),o(this,d,P).call(this),o(this,d,C).call(this),o(this,d,F).call(this),o(this,d,R).call(this)}getCurrentVelocity(){return{x:Math.cos(this.orientation-this.ANGLE_OFFSET),y:Math.sin(this.orientation-this.ANGLE_OFFSET)}}getCollisionShape(){return{x:this.position.x+this.element.clientWidth/2,y:this.position.y+this.element.clientHeight/2,radius:this.element.clientWidth/2}}}d=new WeakSet,R=function(){this.element.style.left=`${this.position.x}px`,this.element.style.top=`${this.position.y}px`,this.element.style.transform=`rotate(${this.orientation}rad)`},T=function(){this.isAccelerating=this.keys.arrowUp.pressed,this.isDecelerating=this.keys.arrowDown.pressed},P=function(){let e=0;this.keys.arrowLeft.pressed&&(e=-1),this.keys.arrowRight.pressed&&(e=1);const t=.03;this.rotaionalVelocity+=e*t;const s=.8;this.rotaionalVelocity*=s;const i=this.ROTATIONAL_SPEED;this.rotaionalVelocity>i&&(this.rotaionalVelocity=i),this.rotaionalVelocity<-i&&(this.rotaionalVelocity=-i),this.orientation+=this.rotaionalVelocity},C=function(){let e=0;this.isAccelerating&&(e=.2);const t=e*Math.cos(this.orientation-this.ANGLE_OFFSET),s=e*Math.sin(this.orientation-this.ANGLE_OFFSET);this.velocity.x+=t,this.velocity.y+=s;const i=.99;this.velocity.x*=i,this.velocity.y*=i,this.isDecelerating&&(this.velocity.x*=.94,this.velocity.y*=.94);const r=Math.sqrt(this.velocity.x**2+this.velocity.y**2),h=this.SPEED;r>h&&(this.velocity.x=this.velocity.x/r*h,this.velocity.y=this.velocity.y/r*h)},F=function(){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y};var y,B,V,$;class ce{constructor({gameScreen:e,spaceshipElement:t,position:s,velocity:i,projectileElement:r,orientation:h}){f(this,y);this.gameScreen=e,this.spaceshipElement=t,this.element=r,this.width=20,this.position=s,this.velocity=i,this.orientation=h,this.hasBeenRenderedOnce=!1,this.isOutside=!1,this.hasHitTarget=!1}update(){o(this,y,V).call(this),o(this,y,$).call(this),o(this,y,B).call(this)}getCollisionShape(){return{x:this.position.x+this.width/2+20,y:this.position.y+this.width/2+20,radius:this.width/2}}}y=new WeakSet,B=function(){this.element.style.left=`${this.position.x}px`,this.element.style.top=`${this.position.y}px`,this.hasBeenRenderedOnce||(this.element.style.width=`${this.width}px`,this.element.style.transform=`
        translateX(${(this.spaceshipElement.clientWidth-this.width)/2}px)
        translateY(${(this.spaceshipElement.clientHeight-this.width)/2}px)
        rotate(${this.orientation}rad)
        translateY(-${(this.spaceshipElement.clientHeight-this.width+30)/2}px)
      `,this.hasBeenRenderedOnce=!0)},V=function(){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y},$=function(){const e=this.gameScreen.getBoundingClientRect(),t=this.element.getBoundingClientRect(),s=t.right<e.left||t.left>e.right||t.bottom<e.top||t.top>e.bottom;this.isOutside=s};var p,G,H,q,z,K;class le{constructor({position:e,velocity:t,width:s,element:i,gameScreen:r}){f(this,p);this.gameScreen=r,this.element=i,this.position=e,this.velocity=t,this.width=s,this.ROTATIONAL_SPEED=-.04+Math.random()*.08,this.orientation=0,this.isOutside=!1,this.hasCollided=!1,this.isShot=!1,this.hasEnteredScreen=!1,this.hasBeenRenderedOnce=!1}update(){o(this,p,H).call(this),o(this,p,q).call(this),this.hasEnteredScreen&&o(this,p,K).call(this),this.hasEnteredScreen||o(this,p,z).call(this),o(this,p,G).call(this)}getCollisionShape(){return{x:this.position.x+this.width/2,y:this.position.y+this.width/2,radius:this.width/2}}}p=new WeakSet,G=function(){this.element.style.left=`${this.position.x}px`,this.element.style.top=`${this.position.y}px`,this.element.style.transform=`rotate(${this.orientation}rad)`,this.hasBeenRenderedOnce||(this.element.style.width=`${this.width}px`,this.hasBeenRenderedOnce=!0)},H=function(){this.orientation+=this.ROTATIONAL_SPEED},q=function(){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y},z=function(){const e=this.position.x+this.width>=20&&this.position.x<=this.gameScreen.clientWidth-20&&this.position.y+this.width>=20&&this.position.y<=this.gameScreen.clientHeight-20;this.hasEnteredScreen=e},K=function(){const e=this.position.x+this.width<20||this.position.x>this.gameScreen.clientWidth-20||this.position.y+this.width<20||this.position.y>this.gameScreen.clientHeight-20;this.isOutside=e};const O=[{level:1,initialAsteroids:3,spawnRate:5e3,speedMultiplier:1},{level:2,initialAsteroids:5,spawnRate:4e3,speedMultiplier:1.2},{level:3,initialAsteroids:7,spawnRate:3e3,speedMultiplier:1.5}],k=60,de=Math.round(1e3/k),pe=120,ue=window.location.hostname==="mrfootwork.github.io",A=ue?"/project-asteroids/":"";var n,x,j,N,U,L,_,W,b,Y,X,J,Q,Z,ee;class me{constructor({gameScreen:e}){f(this,n);this.keys={arrowUp:{pressed:!1},arrowDown:{pressed:!1},arrowLeft:{pressed:!1},arrowRight:{pressed:!1},space:{pressed:!1}},this.gameScreen=e,this.currentFrame=0,this.gameloopIntervalID=null,this.currentLevelIndex=0,this.remainingTime=pe,this.spaceship=new he({spaceshipElement:o(this,n,ee).call(this),gameScreen:e,keys:this.keys}),this.playerLives=3,this.playerScore=0,this.projectiles=[],this.fireRate=Math.round(1e3/12),this.lastFired=0,this.asteroids=[],this.baseAsteroidSpeed=1.5}start(){this.screenSize={width:this.gameScreen.clientWidth,height:this.gameScreen.clientHeight},o(this,n,_).call(this,this.currentLevelIndex),o(this,n,W).call(this,this.currentLevel.initialAsteroids),o(this,n,x).call(this)}resizeScreen(){this.screenSize={width:this.gameScreen.clientWidth,height:this.gameScreen.clientHeight}}getFormattedRemainingTime(){return`${Math.floor(this.remainingTime/60)}:${this.remainingTime%60}`}onKeyDown(e){switch(e.code){case"ArrowUp":case"KeyW":this.keys.arrowUp.pressed=!0;break;case"ArrowDown":case"KeyS":this.keys.arrowDown.pressed=!0;break;case"ArrowLeft":case"KeyA":this.keys.arrowLeft.pressed=!0;break;case"ArrowRight":case"KeyD":this.keys.arrowRight.pressed=!0;break;case"Space":this.keys.space.pressed=!0;break}}onKeyUp(e){switch(e.code){case"ArrowUp":case"KeyW":this.keys.arrowUp.pressed=!1;break;case"ArrowDown":case"KeyS":this.keys.arrowDown.pressed=!1;break;case"ArrowLeft":case"KeyA":this.keys.arrowLeft.pressed=!1;break;case"ArrowRight":case"KeyD":this.keys.arrowRight.pressed=!1;break;case"Space":this.keys.space.pressed=!1;break;case"KeyP":this.pauseOrResumeGame();break}}pauseOrResumeGame(){if(this.gameloopIntervalID){o(this,n,L).call(this);return}if(!this.gameloopIntervalID){o(this,n,x).call(this);return}}}n=new WeakSet,x=function(){this.gameloopIntervalID=setInterval(()=>{if(this.currentFrame++,o(this,n,J).call(this),o(this,n,Q).call(this),o(this,n,U).call(this)){o(this,n,L).call(this),this.playerLives===0&&(this.gameScreen.parentElement.style.backgroundColor="black",this.gameScreen.classList.add("shake"));return}o(this,n,N).call(this)},de)},j=function(){D({spaceshipVelocity:this.spaceship.velocity,backgroundElement:backgroundImageSolid,decelerationFactor:.03}),D({spaceshipVelocity:this.spaceship.velocity,backgroundElement:backgroundImageTransparent,decelerationFactor:.02})},N=function(){this.spaceship.update(),o(this,n,j).call(this),o(this,n,X).call(this),o(this,n,Y).call(this);e:for(let e=this.projectiles.length-1;e>=0;e--){const t=this.projectiles[e];t:for(let s=this.asteroids.length-1;s>=0;s--){const i=this.asteroids[s];if(M(t.getCollisionShape(),i.getCollisionShape())){this.playerScore++,t.hasHitTarget=!0,i.isShot=!0,i.element.remove(),this.asteroids.splice(s,1);break t}}if(t.isOutside||t.hasHitTarget){t.element.remove(),this.projectiles.splice(e,1);continue e}t.update()}for(let e=this.asteroids.length-1;e>=0;e--){const t=this.asteroids[e],s=M(this.spaceship.getCollisionShape(),t.getCollisionShape());if(s&&(t.hasCollided=!0,this.playerLives--,o(this,n,Z).call(this)),s&&!this.playerLives)break;if(t.hasEnteredScreen&&t.isOutside||t.hasCollided||t.isShot||s){t.element.remove(),this.asteroids.splice(e,1);continue}t.update()}},U=function(){const e=this.remainingTime===0,t=this.playerLives===0;return e||t},L=function(){clearInterval(this.gameloopIntervalID),this.gameloopIntervalID=null},_=function(e){this.currentLevel=O[e]},W=function(e){for(let t=0;t<e;t++)o(this,n,b).call(this)},b=function(){let e={x:null,y:null};const t=50+Math.floor(Math.random()*150),s=["top","right","bottom","left"][Math.floor(Math.random()*4)];let i=null;const r=.3,h=r*Math.random()-r/2;let c=null;const m=1/1.1;switch(s){case"top":e.x=Math.floor(Math.random()*this.screenSize.width),e.y=0-t,c=(e.x/this.screenSize.width-.5)*m,i=(.5+h+c)*Math.PI;break;case"right":e.x=this.screenSize.width+100,e.y=Math.floor(Math.random()*this.screenSize.height),c=(e.y/this.screenSize.height-.5)*m,i=(1+h+c)*Math.PI;break;case"bottom":e.x=Math.floor(Math.random()*this.screenSize.width),e.y=this.screenSize.height,c=(e.x/this.screenSize.width-.5)*m,i=(1.5+h-c)*Math.PI;break;case"left":e.x=0-t,e.y=Math.floor(Math.random()*this.screenSize.height),c=(e.y/this.screenSize.height-.5)*m,i=(2+h-c)*Math.PI;break}const S=.2+Math.random()*this.baseAsteroidSpeed*this.currentLevel.speedMultiplier,v={x:S*Math.cos(i),y:S*Math.sin(i)},g=document.createElement("div");g.className="asteroid";const w=document.createElement("img");w.src=`${A}assets/images/asteroid.png`,g.appendChild(w),this.gameScreen.appendChild(g);const E=new le({position:e,velocity:v,width:t,element:g,gameScreen:this.gameScreen});this.asteroids.push(E)},Y=function(){this.currentFrame*k%O[this.currentLevelIndex].spawnRate===0&&o(this,n,b).call(this)},X=function(){const e=Date.now();if(this.keys.space.pressed&&e-this.lastFired>=this.fireRate){this.lastFired=e;const t=document.createElement("div");t.className="projectile",this.gameScreen.appendChild(t);const s=new ce({gameScreen:this.gameScreen,position:{x:this.spaceship.position.x,y:this.spaceship.position.y},velocity:{x:8*this.spaceship.getCurrentVelocity().x,y:8*this.spaceship.getCurrentVelocity().y},projectileElement:t,orientation:this.spaceship.orientation,spaceshipElement:this.spaceship.element});this.projectiles.push(s)}},J=function(){this.currentFrame%k===0&&(this.remainingTime--,timeDisplay.textContent=this.getFormattedRemainingTime())},Q=function(){scoreDisplay.textContent=this.playerScore},Z=function(){livesDisplay.textContent=this.playerLives},ee=function(){const e=document.createElement("div");e.id="spaceship";const t=document.createElement("img");return t.src=`${A}assets/images/spaceship.png`,e.appendChild(t),this.gameScreen.appendChild(e),e};function M(a,e){const t=e.x-a.x,s=e.y-a.y;return Math.sqrt(t**2+s**2)<a.radius+e.radius}function D({spaceshipVelocity:a,backgroundElement:e,decelerationFactor:t}){const s=window.getComputedStyle(e),i=s.backgroundPosition.includes(", "),r=i?1:0,[h,c]=i?s.backgroundPosition.split(", ")[r].split(" "):s.backgroundPosition.split(" "),m=parseFloat(h)+a.x*t,S=parseFloat(c)+a.y*t;e.style.backgroundPosition=`${i?"50% 50%, ":""}${m}% ${S}%`}let u;document.addEventListener("DOMContentLoaded",()=>{const a=document.querySelector("#homeScreen"),e=document.querySelector("#startButton"),t=document.querySelector("#gameScreen");let s,i,r,h;const c=document.querySelector("#resultScreen"),m=document.querySelector("#toHomeButton"),S=document.querySelector("#restartButton");e.addEventListener("click",v),m.addEventListener("click",w),S.addEventListener("click",v);function v(){console.warn("changeViewToGame"),te(),ie(),se(),E(),ne(),oe(),a.style.display="none",t.style.display="block",c.style.display="none"}function g(){a.style.display="none",t.style.display="none",c.style.display="block"}function w(){a.style.display="block",t.style.display="none",c.style.display="none"}function E(){u=new me({gameScreen:t}),requestAnimationFrame(()=>{u.start()})}function te(){const l=document.createElement("div"),re=`
			<div>
				<button id="gameOverButton">Game Over</button>
				<button id="pauseButton">Pause / Play</button>
			</div>
			<div>
				<p>Time to survive: <span id="timeDisplay">2:00</span></p>
			</div>
			<div>
				<p>☄ Score <span id	="scoreDisplay">0</span></p>
				<p>❤ Lives <span id	="livesDisplay">3</span></p>
			</div>
		`;l.innerHTML=re,t.replaceChildren(l)}function ie(){s=document.createElement("div"),i=document.createElement("div"),s.id="backgroundImageSolid",i.id="backgroundImageTransparent",t.appendChild(s),t.appendChild(i)}function se(){s=document.querySelector("#backgroundImageSolid"),i=document.querySelector("#backgroundImageTransparent"),r=document.querySelector("#gameOverButton"),h=document.querySelector("#pauseButton"),document.querySelector("#timeDisplay"),document.querySelector("#scoreDisplay"),document.querySelector("#livesDisplay")}function ne(){window.removeEventListener("resize",u.resizeScreen),r.removeEventListener("click",g),h.removeEventListener("click",l=>u.pauseOrResumeGame(l)),document.removeEventListener("keydown",l=>u.onKeyDown(l)),document.removeEventListener("keyup",l=>u.onKeyUp(l))}function oe(){window.addEventListener("resize",u.resizeScreen),r.addEventListener("click",g),h.addEventListener("click",l=>u.pauseOrResumeGame(l)),document.addEventListener("keydown",l=>u.onKeyDown(l)),document.addEventListener("keyup",l=>u.onKeyUp(l))}});
