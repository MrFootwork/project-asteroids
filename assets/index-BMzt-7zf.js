var x=r=>{throw TypeError(r)};var U=(r,e,t)=>e.has(r)||x("Cannot "+t);var f=(r,e,t)=>e.has(r)?x("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t);var n=(r,e,t)=>(U(r,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();var l,I,b,A,M,R;class _{constructor({spaceshipElement:e,gameScreen:t,keys:i}){f(this,l);this.gameScreen=t,this.element=e,this.keys=i,this.isAccelerating=!1,this.isDecelerating=!1,this.ANGLE_OFFSET=Math.PI/2,this.SPEED=8,this.ROTATIONAL_SPEED=.2,this.position={x:200,y:400},this.velocity={x:0,y:0},this.rotaionalVelocity=0,this.orientation=0,this.thrustOrientation=0}update(){n(this,l,b).call(this),n(this,l,A).call(this),n(this,l,M).call(this),n(this,l,R).call(this),n(this,l,I).call(this)}getCurrentVelocity(){return{x:Math.cos(this.orientation-this.ANGLE_OFFSET),y:Math.sin(this.orientation-this.ANGLE_OFFSET)}}getCollisionShape(){return{x:this.position.x+this.element.clientWidth/2,y:this.position.y+this.element.clientHeight/2,radius:this.element.clientWidth/2}}}l=new WeakSet,I=function(){this.element.style.left=`${this.position.x}px`,this.element.style.top=`${this.position.y}px`,this.element.style.transform=`rotate(${this.orientation}rad)`},b=function(){this.isAccelerating=this.keys.arrowUp.pressed,this.isDecelerating=this.keys.arrowDown.pressed},A=function(){let e=0;this.keys.arrowLeft.pressed&&(e=-1),this.keys.arrowRight.pressed&&(e=1);const t=.03;this.rotaionalVelocity+=e*t;const i=.8;this.rotaionalVelocity*=i;const s=this.ROTATIONAL_SPEED;this.rotaionalVelocity>s&&(this.rotaionalVelocity=s),this.rotaionalVelocity<-s&&(this.rotaionalVelocity=-s),this.orientation+=this.rotaionalVelocity},M=function(){let e=0;this.isAccelerating&&(e=.2);const t=e*Math.cos(this.orientation-this.ANGLE_OFFSET),i=e*Math.sin(this.orientation-this.ANGLE_OFFSET);this.velocity.x+=t,this.velocity.y+=i;const s=.99;this.velocity.x*=s,this.velocity.y*=s,this.isDecelerating&&(this.velocity.x*=.94,this.velocity.y*=.94);const o=Math.sqrt(this.velocity.x**2+this.velocity.y**2),h=this.SPEED;o>h&&(this.velocity.x=this.velocity.x/o*h,this.velocity.y=this.velocity.y/o*h)},R=function(){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y};var y,C,D,P;class W{constructor({gameScreen:e,spaceshipElement:t,position:i,velocity:s,projectileElement:o,orientation:h}){f(this,y);this.gameScreen=e,this.spaceshipElement=t,this.element=o,this.position=i,this.velocity=s,this.orientation=h,this.hasBeenRenderedOnce=!1,this.isOutside=!1,this.isCollided=!1,this.width=20}update(){n(this,y,C).call(this),n(this,y,D).call(this),n(this,y,P).call(this)&&(this.element.remove(),this.isOutside=!0),this.isCollided&&this.element.remove()}getCollisionShape(){return{x:this.position.x+this.width/2+20,y:this.position.y+this.width/2+20,radius:this.width/2}}}y=new WeakSet,C=function(){this.element.style.left=`${this.position.x}px`,this.element.style.top=`${this.position.y}px`,this.hasBeenRenderedOnce||(this.element.style.width=`${this.width}px`,this.element.style.transform=`
        translateX(${(this.spaceshipElement.clientWidth-this.width)/2}px)
        translateY(${(this.spaceshipElement.clientHeight-this.width)/2}px)
        rotate(${this.orientation}rad)
        translateY(-${(this.spaceshipElement.clientHeight-this.width+30)/2}px)
      `,this.hasBeenRenderedOnce=!0)},D=function(){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y},P=function(){const e=this.gameScreen.getBoundingClientRect(),t=this.element.getBoundingClientRect();return t.right<e.left||t.left>e.right||t.bottom<e.top||t.top>e.bottom};var d,B,F,j,z,K;class Y{constructor({position:e,velocity:t,width:i,element:s,gameScreen:o}){f(this,d);this.element=s,this.position=e,this.velocity=t,this.width=i,this.orientation=0,this.ROTATIONAL_SPEED=-.04+Math.random()*.08,this.isOutside=!1,this.isCollided=!1,this.hasEnteredScreen=!1,this.hasBeenRenderedOnce=!1,this.gameScreen=o}update(){n(this,d,F).call(this),n(this,d,j).call(this),n(this,d,B).call(this),this.hasEnteredScreen||n(this,d,z).call(this),this.hasEnteredScreen&&n(this,d,K).call(this),this.hasEnteredScreen&&this.isOutside&&(this.element.remove(),this.isOutside=!0),this.isCollided&&this.element.remove()}getCollisionShape(){return{x:this.position.x+this.width/2,y:this.position.y+this.width/2,radius:this.width/2-10}}}d=new WeakSet,B=function(){this.element.style.left=`${this.position.x}px`,this.element.style.top=`${this.position.y}px`,this.element.style.transform=`rotate(${this.orientation}rad)`,this.hasBeenRenderedOnce||(this.element.style.width=`${this.width}px`,this.hasBeenRenderedOnce=!0)},F=function(){this.orientation+=this.ROTATIONAL_SPEED},j=function(){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y},z=function(){const e=this.gameScreen.getBoundingClientRect(),t=this.element.getBoundingClientRect(),i=t.right>=e.left&&t.left<=e.right&&t.bottom>=e.top&&t.top<=e.bottom;this.hasEnteredScreen=i},K=function(){const e=this.gameScreen.getBoundingClientRect(),t=this.element.getBoundingClientRect(),i=t.right<e.left||t.left>e.right||t.bottom<e.top||t.top>e.bottom;this.isOutside=i};const X=[{level:1,initialAsteroids:10,spawnRate:5e3,speedMultiplier:1},{level:2,initialAsteroids:5,spawnRate:4e3,speedMultiplier:1.2},{level:3,initialAsteroids:7,spawnRate:3e3,speedMultiplier:1.5}],L=Math.round(1e3/60),J=window.location.hostname==="mrfootwork.github.io",O=J?"/project-asteroids/":"";var a,E,T,$,N,q,G,V,H;class Q{constructor({gameScreen:e}){f(this,a);this.keys={arrowUp:{pressed:!1},arrowDown:{pressed:!1},arrowLeft:{pressed:!1},arrowRight:{pressed:!1},space:{pressed:!1}},this.gameScreen=e,this.spaceship=new _({spaceshipElement:n(this,a,H).call(this),gameScreen:e,keys:this.keys}),this.projectiles=[],this.asteroids=[],this.currentLevelIndex=0,this.fireRate=Math.round(1e3/12),this.lastFired=0,this.baseAsteroidSpeed=1.5,this.currentFrame=0,this.gameloopIntervalID=null,this.spawnIntervalID=null}start(){requestAnimationFrame(()=>{this.screenSize={width:this.gameScreen.clientWidth,height:this.gameScreen.clientHeight},n(this,a,T).call(this,this.currentLevelIndex),n(this,a,N).call(this),this.gameloopIntervalID=setInterval(()=>{n(this,a,E).call(this),this.currentFrame++},L)})}resume(){this.gameloopIntervalID=setInterval(()=>{n(this,a,E).call(this),this.currentFrame++},L)}resizeScreen(){this.screenSize={width:this.gameScreen.clientWidth,height:this.gameScreen.clientHeight}}onKeyDown(e){switch(e.code){case"ArrowUp":case"KeyW":this.keys.arrowUp.pressed=!0;break;case"ArrowDown":case"KeyS":this.keys.arrowDown.pressed=!0;break;case"ArrowLeft":case"KeyA":this.keys.arrowLeft.pressed=!0;break;case"ArrowRight":case"KeyD":this.keys.arrowRight.pressed=!0;break;case"Space":this.keys.space.pressed=!0;break}}onKeyUp(e){switch(e.code){case"ArrowUp":case"KeyW":this.keys.arrowUp.pressed=!1;break;case"ArrowDown":case"KeyS":this.keys.arrowDown.pressed=!1;break;case"ArrowLeft":case"KeyA":this.keys.arrowLeft.pressed=!1;break;case"ArrowRight":case"KeyD":this.keys.arrowRight.pressed=!1;break;case"Space":this.keys.space.pressed=!1;break;case"KeyP":this.onPause();break}}onPause(){if(this.gameloopIntervalID){clearInterval(this.gameloopIntervalID),this.gameloopIntervalID=null;return}this.gameloopIntervalID||this.resume()}}a=new WeakSet,E=function(){this.spaceship.update(),n(this,a,V).call(this),n(this,a,G).call(this);for(let e=this.projectiles.length-1;e>=0;e--){this.projectiles[e].update();for(let t=this.asteroids.length-1;t>=0;t--)k(this.projectiles[e].getCollisionShape(),this.asteroids[t].getCollisionShape())&&(this.projectiles[e].isCollided=!0,this.projectiles[e].update(),this.projectiles.splice(e,1),this.asteroids[t].isCollided=!0,this.asteroids[t].update(),this.asteroids.splice(t,1));this.projectiles[e].isOutside&&this.projectiles.splice(e,1)}for(let e=this.asteroids.length-1;e>=0;e--)k(this.spaceship.getCollisionShape(),this.asteroids[e].getCollisionShape())&&(clearInterval(this.gameloopIntervalID),this.gameScreen.parentElement.style.backgroundColor="black",this.gameScreen.classList.add("shake")),this.asteroids[e].update(),this.asteroids[e].isOutside&&this.asteroids.splice(e,1)},T=function(e){this.currentLevel=X[e],n(this,a,$).call(this,this.currentLevel.initialAsteroids)},$=function(e){for(let t=0;t<e;t++)n(this,a,q).call(this)},N=function(){const e=document.createElement("div"),t=`
			<p>Score <span>0</span></p>
			<p>Lives <span>3</span></p>
		`;e.innerHTML=t,this.gameScreen.appendChild(e)},q=function(){let e={x:null,y:null};const t=50+Math.floor(Math.random()*150),i=["top","right","bottom","left"][Math.floor(Math.random()*3)];let s=null;const o=.3,h=o*Math.random()-o/2;let c=null;const m=1/1.1;switch(i){case"top":e.x=Math.floor(Math.random()*this.screenSize.width),e.y=0-t,c=(e.x/this.screenSize.width-.5)*m,s=(.5+h+c)*Math.PI;break;case"right":e.x=this.screenSize.width-100,e.y=Math.floor(Math.random()*this.screenSize.height),c=(e.y/this.screenSize.height-.5)*m,s=(1+h+c)*Math.PI;break;case"bottom":e.x=Math.floor(Math.random()*this.screenSize.width),e.y=this.screenSize.height,c=(e.x/this.screenSize.width-.5)*m,s=(1.5+h-c)*Math.PI;break;case"left":e.x=0-t,e.y=Math.floor(Math.random()*this.screenSize.height),c=(e.y/this.screenSize.height-.5)*m,s=(2+h-c)*Math.PI;break}const S=.2+Math.random()*this.baseAsteroidSpeed*this.currentLevel.speedMultiplier,p={x:S*Math.cos(s),y:S*Math.sin(s)},g=document.createElement("div");g.className="asteroid";const v=document.createElement("img");v.src=`${O}assets/images/asteroid.png`,g.appendChild(v),this.gameScreen.appendChild(g);const w=new Y({position:e,velocity:p,width:t,element:g,gameScreen:this.gameScreen});this.asteroids.push(w)},G=function(){},V=function(){const e=Date.now();if(this.keys.space.pressed&&e-this.lastFired>=this.fireRate){this.lastFired=e;const t=document.createElement("div");t.className="projectile",this.gameScreen.appendChild(t);const i=new W({gameScreen:this.gameScreen,position:{x:this.spaceship.position.x,y:this.spaceship.position.y},velocity:{x:8*this.spaceship.getCurrentVelocity().x,y:8*this.spaceship.getCurrentVelocity().y},projectileElement:t,orientation:this.spaceship.orientation,spaceshipElement:this.spaceship.element});this.projectiles.push(i)}},H=function(){const e=document.createElement("div");e.id="spaceship";const t=document.createElement("img");return t.src=`${O}assets/images/spaceship.png`,e.appendChild(t),this.gameScreen.appendChild(e),e};function k(r,e){const t=e.x-r.x,i=e.y-r.y;return Math.sqrt(t**2+i**2)<r.radius+e.radius}document.addEventListener("DOMContentLoaded",()=>{const r=document.querySelector("#homeScreen"),e=document.querySelector("#startButton");let t=document.querySelector("#gameScreen"),i=document.querySelector("#gameOverButton"),s=document.querySelector("#pauseButton");const o=document.querySelector("#resultScreen"),h=document.querySelector("#toHomeButton");e.addEventListener("click",c),i.addEventListener("click",m),s.addEventListener("click",u=>p.onPause(u)),h.addEventListener("click",S);function c(){g(),w(),r.style.display="none",t.style.display="block"}function m(){t.style.display="none",o.style.display="block",v()}function S(){o.style.display="none",r.style.display="block"}let p;function g(){p=new Q({gameScreen:t}),p.start()}c();function v(){i.removeEventListener("click",m),t.innerHTML='<button id="gameOverButton">Game Over</button>',i=document.querySelector("#gameOverButton"),i.addEventListener("click",m),s.removeEventListener("click",onPause),s=document.createElement("button"),s.id="pauseButton",s.textContent="Pause / Play",t.appendChild(s),s=document.querySelector("#pauseButton"),s.addEventListener("click",onPause)}function w(){document.removeEventListener("keydown",u=>p.onKeyDown(u)),document.removeEventListener("keyup",u=>p.onKeyUp(u)),window.removeEventListener("resize",p.resizeScreen),document.addEventListener("keydown",u=>p.onKeyDown(u)),document.addEventListener("keyup",u=>p.onKeyUp(u)),window.addEventListener("resize",p.resizeScreen)}});
